* 레지스트리: 도커 이미지를 제공하는 저장소
*  도커 허브: 무료로 제공되는 공개 레지스트리


### Dockerfile 스크립트 최적화하기

* 도커 이미지는 여러 개의 이미지 레이어로 구성된다 
    * 도커 이미지를 마치 하나의 압축파일로, 이미지 레이어를 마치 해당 압축파일을 구성하는 여러 개의 작은 파일로 생각할 수 있다
* 각 이미지 레이어는 도커엔진의 캐시에 물리적으로 저장되는 파일이다. 
  * 즉, 이미지 레이어는 여러 개의 이미지와 컨테이너에서 공유될 수 있다. 
  * 그렇기 때문에 이미지 레이어는 읽기 전용으로, 수정할 수 없다
  
* Dockerfile: 어플리케이션을 패키징하기 위한 간단한 스크립트로, 일련의 인스트럭션으로 구성된다
  * 컨텍스트: Dockerfile 및 이미지에 포함시킬 파일이 위치한 경로
  * Dockerfile 인스트럭션과 이미지 레이어는 1:1 관계를 갖는다

* 도커 엔진의 캐시에 이미지 레이어가 존재하는지 확인하기 위해, 도커는 ‘해시값’을 사용한다
    * 이 해시값을 계산하기 위한 인풋은 (1) Dockerfile 스크립트의 인스트럭션 (2) 인스트럭션에 의해 복사되는 파일의 내용
    * 캐시에 이미지 레이어가 존재할 경우, 이를 재사용할 수 있다. 캐시미스가 발생할 경우 인스트럭션을 새로 실행한다
* 디스크 용량, 네트워크 대역폭 절약을 위해 이미지 레이어를 재사용하려면, 잘 수정되지 않을 인스트럭션을 앞으로 빼고 자주 수정될 인스트럭션을 뒤로 배치하는 것이 좋다

### 다른 환경에도 어플리케이션을 배포할 수 있도록 이식성 있는 이미지 만들기
* 도커 컨테이너 별로 별도의 환경변수를 가질 수 있다
    * 환경변수: 운영체제에서 제공하는 키-값 쌍
    * 도커 컨테이너의 환경변수는 도커가 부여해준다


### 명령어 모음

`docker container run -d —name {container-name} {image-name}`

내려받은 이미지로 컨테이너를 백그라운드에서 실행하고, 컨테이너에 이름을 붙여준다

`docker container logs {container-name}`

해당 컨테이너의 로그를 조회한다

`docker rm -f {container-name}`

해당 컨테이너를 삭제한다 (-f 옵션을 주면 실행중인 컨테이너도 강제로 삭제한다)

`docker container run —env {key}={value} {image-name}`

이미지를 내려받고 환경변수 값을 지정하여 컨테이너를 실행한다

`docker image build —tag {container-name} .`

현재 작업 디렉토리에 있는 Dockerfile 스크립트로 이미지를 빌드한다

`docker image ls ‘{search-keyword}*’`

해당 키워드로 시작하는 태그명을 가진 이미지 목록을 확인한다

`docker image history {comtainer-name}`

컨테이너의 히스토리 확인하기

`docker system df`

도커 이미지 저장에 실제로 사용된 디스크 용량 확인하기