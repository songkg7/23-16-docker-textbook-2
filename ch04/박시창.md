# 4. 애플리케이션 소스코드에서 도커 이미지까지
 - **애플리케이션**을 Docker 스크립트로 패키징하는 방법 배우기
   
## 4.1 Dockerfile이 있는데 빌드 서버가 필요할까?
  
- **필요성 - 유연성**
    - 빌드서버와 개인 환경에서의 빌드가 달라서 모두 같은 버전의 도구들을 사용해야함
    - 이러한 문제는 피하기 너무 힘듬

- **멀티 스테이지 빌드**
    - build-stage 단계에서 파일하나를 생성
    - test-stage 단계에서 복사
    - 마지막 실행하는 단계에 복사
    - 해당 스테이지들을 확인해보면서 빌드의 의존 모듈들과 테스트의 의존모듈과 실행 환경을 다 분리할 수 있음(이식성)
    - 어느 환경에서도 동일한 툴을 사용해서 빌드서버와 동일한 툴로 빌드가 가능해진다.
  
## 4.2 애플리케이션 빌드 실전 예제: 자바 코드
  - **builder** 스텝
  - builder 이미지에서 컴파일된 애플리케이션을 maven에서 수행할 빌드 진행 (빌드 도구 jdk, mvaen 포함)
  - Run 인스트럭션에서는 필요한 의존 모듈 내려받기
  - copy 에서는 소스코드를 현재 이미지 내로 복사
  - mvn package 로 jar 파일로 빌드후에 패키징 지행
  - **마지막 단계** 스텝
  - 자바 11 런타임 포함
  - builder 에서 jar 파일을 가져온다.
  - 80 으로 port expose 시킨다
  - ENTRYPOINT 로 해당 JAR를 실행한다.

  - 여기서 중요한 점은 애플리케이션 이미지에 빌드 도구는 포함되지 않아서 취약점같은 조치가 필요가 없다.
    
## 4.3 애플리케이션 빌드 실전 예제: Node.js 소스 코드
  - 앞서 본 JAVA와 기술 스택, 패키징 패턴, 기반 이미지, 빌드 도구, 실행 명령 다 다르지만 똑같이 Dockerfile로 패키징이 가능하다.
        
## 4.4 애플리케이션 빌드 실전 예제: GO 소스 코드
  - 앞서 본 JAVA와 기술 스택, 패키징 패턴, 기반 이미지, 빌드 도구, 실행 명령 다 다르지만 똑같이 Dockerfile로 패키징이 가능하다.
  - 
## 4.5 멀티 스테이지 Dockerfile 스크립트 이해하기
    - 어떤 언어의 비르도구 설치 필요없이 다커만 필요했다.
    - 장점 표준화
      - 빌드 서버 필요없음
    - 성능 향상
      - 멀티 스테이지 빌드로 캐시 사용으로 최적화가 가능하다.
    - application을 작게 유지가능하다.
   

