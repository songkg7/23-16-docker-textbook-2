# 8. 헬스 체크와 디펜던시 체크
 - 비정상 컨테이너를 빠르게 교체해주기위한 컨테이너내 이상감지 포착 기능
   
## 8.1 헬스 체크
  - 도커 스크립트내에서 기본적인 헬스체크가 가능하다.
  - `HEALTHCHECK CMD curl --fail http://localhost/health`
  - 이상이 생긴 컨테이너 교체를 못하고 헬스체크도 계속 수행
  - 보통 다른 컨테이너 생산하고 제거
 
## 8.2 디펜던시 체크
  - 컨테이너간 의존관계 고려하지 않음
  - 실행순서는 통제할 수 없음
  - 대부분의 애플리케이션에는 의존관계 로직이 없다.
  - 디펜던시 체크를 도커 이미지에 추가 가능하다.
  - `CMD curl --fail 요청 && 애플리케이션 실행`
  - 이렇게 실패시에는 명령을 실행할 수 없게 진행한다.

    
## 8.3 애플리케이션 체크
  - curl < 웹애플리케이션과 같은 언어로 커스텀 유틸리티
  - 이미지 추가적 소프트웨어 필요없음
  - 까다로운 로직을 생성 가능
  - db 접속, 인증서 파일 유무 모든 사항 검증 가능
        
## 8.4 컴포즈 디펜던시 체크
  - 헬스체크 옵션 사용 가능
  - `healthcheck: interval: 5s`
  - interval 은 5초
  - timeout 은 제한시간
  - retries 실패 연속 횟수
  - start_period 헬스체크 간격 횟수
  - `test: ["CMD", "javac", "utilites.jar"]`
  - depends on 잘 안씀 -> 운영환경에서는 모든 상황이 연출된다.
    
    
## 8.5 헬스 체크와 디펜던시 체크 합쳐서 사용하기
  - 자기수복 방법
  - 순서없이 컨테이너를 띄우되 실패시 컨테이너를 다시 띄우기

## 8.6 연습 문제
