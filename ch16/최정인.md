---
marp: true
---

## 16장 어디서든 실행할 수 있는 도커 이미지 만들기: 리눅스, 윈도, 인텔, ARM
16.1 다중 아키텍처 이미지가 중요한 이유
16.2 다중 아키텍처 이미지를 만들기 위한 Dockerfile 스크립트
16.3 다중 아키텍처 이미지를 레지스트리에 푸시하기
16.4 도커 Buildx를 사용해 다중 아키텍처 이미지 빌드하기
16.5 개발 로드맵과 다중 아키텍처 이미지

---

### 다중 아키텍처 이미지
다중 아키텍처 이미지는 여러 개의 변종 이미지 형태로 빌드되고 레지스트리에 푸시됨. 
각각의 변종 이미지는 서로 다른 아키텍처나 운영체제 환경을 대상으로 함. 
다중 아키텍처 이미지를 특정 컴퓨터에서 내려받으면, 도커는 현재 컴퓨터의 아키텍처와 운영체제에 일치하는 변종 이미지를 받아온다.

### 다중 아키텍처 이미지 만들기
method 1) 멀티스테이지 Dockerfile 스크립트를 이용해서 컨테이너에서 소스코드를 빌드하고 패키징하는 방법
장점 - Dockerfile 스크립트 하나로 다른 아키텍처의 컴퓨터에서 이미지를 빌드하면 해당 아키텍처의 이미지를 만들 수 있다는 점. 
단점 - 빌드에 사용된 이미지가 다중 아키텍처 이미지가 아니거나 원하는 아키텍처를 모두 지원하지 않으면 사용할 수 없음. 
method 2) Dockerfile 스크립트를 아키텍처나 운영체제 별로 다 따로 작성
단점 - 관리 업무가 늘어남. 

--- 
### 다중 아키텍처 이미지를 레지스트리에 푸시하기
다양한 아키텍처의 리눅스 이미지를 다중 아키텍처 이미지로 만들려면, 매니페스트와 함께 이들 이미지를 레지스트리에 푸시해야 한다
매니페스트 - 여러 변종 이미지를 하나의 이미지 태그로 묶는 메타데이터. 이미지 변종의 목록이 담기게 되는데, 일단 이들 이미지가 먼저 레지스트리에 푸시된 상태여야 함.
즉, 변종 이미지를 모두 푸시한 다음 매니페스트 작성하고 푸시해야 함.