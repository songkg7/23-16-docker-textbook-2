# 18. 컨테이너의 애플리케이션 설정 관리
- 여러가지 아키텍처를 지원하면서 운영비가 싼 ARM 이나 개발환경(MAC, WINDOWS)에 필요한 환경 지원 바로 가능하다.

## 18.1 상황별 애플리케이션 설정
- `버전에 따라 달라지는 설정`
- `환경에 따라 달라지는 설정`
- `기능 설정` 
- 기본 설정 -> 오버라이드 설정 파일 -> 환경변수 순으로 병합시켜서 사용하면된다.

## 18.2 환경별 설정 패키징하기
- appsettings.json : 모든 환경에 공통적으로 적용되는 설정
- appsettings{환경_이름}.json: 환경별로 적용되는 오버라이드 설정 파일
- 환경 변수: 환경 이름 정의 및 오버라이드 설정
- `docker container run -d -p 8084:80 -e DOTNET_ENVIRONMENT=Test image`
- 단점은 이미지에 포함 시킬수 없는 설정을 주입해야된다
- 개발 과 설정 관리 분리가 가능하다.
- `-e DOTNET_ENVIRONMENT=Production -v "$(pwd)/config/prod-local:/app/config-override image`
- 로컬설정값을 마운트시켜 사용한다.

## 18.3 런타임에서 설정 읽기
- config 디렉터리에서 기본설정파일을 읽는다.
- config-override 디렉터리에서 읽어드린다. 해당 디렉터리는 파일 시스템 마운트로 주입된다.
- 환경 변수는 설정 파일의 설정값으르 오버라이드 할 수 있다.
- 설정 API 기능은 매우 유용하고 민감한 데이터를 보호하면서 설정을 디버깅하기 쉽다.
  -  전체 설정은 공개하지 않는다.
  - 엔드포인트에 보안설정한다.
  - 설정 API의 사용여부를 설정할 수 있다.


## 18.4 레거시 에서 설정 전략 적용하기
- 컨테이너에서 지정된 오버라이드 설정 파일 읽기
- 환경 변수에서 오버라이드 설정 읽기
- 환경 변수 설정을 병합하기, 이때 환경변수 우선순위준다
- 병합된 오버라이드 설정을 컨테이너 내 대상 설정 파일을 추가한다.
- `docker run -d -p 8091:80 -v "$(pwd)/config/dev:;/config-override" -e CONFIG_SOURCE_PATH="/config-override/application.properties"`

## 18.5 유연항 설정 모델의 이점
- 버전에 따라 달라지는 설정은 이미지에 포함시키고
- 환경별 달라지는 설정은 오버라이드 파일을 통해 적용하며
- 환경 변수를 통해 기능별 설정도 덧붙일 수 있다.

