---
marp: true
---
# 18장. 컨테이너의 애플리케이션 설정 관리
---
## 다단 애플리케이션 설정
* 설정 모델은 설정에 담긴 데이터의 구조를 반영해야 합니다.
* 설정 데이터의 종류는 주로 3가지가 있습니다.
    1. 버전에 따라 달라지는 설정 : 모든 환경에서 동일하지만 버전별로 달라지는 설정
    2. 환경에 따라 달라지는 설정 : 환경별로 달라지는 설정
    3. 기능 설정 : 버전별로 애플리케이션의 동작을 달리하기 위한 설정

---
## 환경별 설정 패키징하기
여러 가지 애플리케이션 프레임워크에서 환경별 설정 파일을 모두 배포에 포함시킬 수 있는 기능을 제공
- application.yaml
- application-{환경}.yaml
- 환경 변수(환경 이름 정의)

---
## 런타임에서 설정 읽어 들이기
설정 API를 통해 현재 설정 내용을 출력할때 비밀값과 같은 민감 정보를 API를 통해 노출하지 않기 위해서는 다음을 만족시켜야한다.
* 전체 설정을 공개하지 않습니다. 민감하지 않은 정보만 선택하되 민감한 정보는 절대 포함시키지 않는다.
* 허가받은 사용자만이 접근할 수 있도록 엔드포인트에 보안을 설정한다.
* 설정 API의 사용 여부를 설정할 수 있어야 한다.

  ---
# 레거시 애플리케이션에 설정 전략 적용하기

**Dockerfile 스크립트로 설정하기**

1. 컨테이너에 지정된 오버라이드 설정 파일 읽어들이기
2. 환경 변수에서 오버라이드 설정을 읽어들이기
3. 오버라이드 설정 파일과 환경 변수를 병합하기. 환경 변수값 우선한다
4. 병합된 오버라이드 설정을 컨테이너 내 대상 설정 파일에 추가하기
---
